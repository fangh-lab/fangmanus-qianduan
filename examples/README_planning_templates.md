# 规划模板使用指南

## 概述

本目录包含用于 `run_flow` 模式的规划模板文件。这些模板可以作为智能体规划的基础，帮助生成符合部门业务标准的执行计划。

## 模板文件

### 1. customer_service_template.txt
**用途**：客户服务业务流程规划模板

**适用场景**：
- 处理客户投诉
- 客户咨询回复
- 客户满意度调查
- 客户关系维护

**使用示例**：
```bash
python run_flow.py
# Enter planning file path: examples/planning_templates/customer_service_template.txt
# Enter your prompt: 处理客户投诉工单 #12345，客户反映产品质量问题
```

### 2. data_analysis_template.txt
**用途**：数据分析业务流程规划模板

**适用场景**：
- 销售数据分析
- 用户行为分析
- 业务指标分析
- 数据报表生成

**使用示例**：
```bash
python run_flow.py
# Enter planning file path: examples/planning_templates/data_analysis_template.txt
# Enter your prompt: 分析最近一个月的销售数据，找出销售趋势和潜在问题
```

### 3. software_development_template.txt
**用途**：软件开发业务流程规划模板

**适用场景**：
- 新功能开发
- Bug 修复
- 代码重构
- 技术债务清理

**使用示例**：
```bash
python run_flow.py
# Enter planning file path: examples/planning_templates/software_development_template.txt
# Enter your prompt: 开发一个简单的待办事项管理应用
```

## 快速测试

### 方法1：使用测试脚本
```bash
python examples/test_run_flow_with_template.py
```

测试脚本会：
1. 显示可用的规划模板列表
2. 让您选择模板或输入自定义文件路径
3. 提供示例提示词或允许自定义输入
4. 执行完整的流程（包括人类反馈环节）

### 方法2：直接运行 run_flow.py
```bash
python run_flow.py
# 然后按照提示输入规划文件路径和业务请求
```

## 模板格式说明

规划模板文件采用 Markdown 格式，包含以下部分：

1. **业务概述**：说明模板的用途和适用场景
2. **标准流程步骤**：详细列出各个阶段的步骤
3. **注意事项**：重要的业务规则和约束
4. **质量标准**：可量化的质量指标

## 创建自定义模板

您可以基于现有模板创建符合自己部门业务的自定义模板：

1. 复制一个现有模板文件
2. 修改业务概述和流程步骤
3. 添加您部门的特定注意事项和质量标准
4. 保存为新的模板文件

**模板编写建议**：
- 使用清晰的标题和层次结构
- 步骤描述要具体可执行
- 包含明确的输入输出说明
- 添加必要的业务规则和约束

## 工作流程

使用规划模板的完整工作流程：

```
1. 准备规划模板文件
   ↓
2. 运行 run_flow.py
   ↓
3. 输入规划模板文件路径（可选）
   ↓
4. 输入业务请求
   ↓
5. 智能体基于模板生成规划
   ↓
6. 【人类反馈】确认规划是否符合预期
   ↓
7. 执行规划中的每个步骤
   ↓
8. 【人类反馈】每步执行后确认结果
   ↓
9. 完成所有步骤并生成总结
```

## 示例场景

### 场景1：客户投诉处理
```
规划模板：customer_service_template.txt
业务请求：处理客户投诉工单 #12345，客户反映产品质量问题，需要尽快解决

预期规划步骤：
1. 接收并分析投诉工单 #12345
2. 联系客户了解详细情况
3. 制定解决方案
4. 执行解决方案
5. 跟进并确认客户满意度
```

### 场景2：销售数据分析
```
规划模板：data_analysis_template.txt
业务请求：分析最近一个月的销售数据，找出销售趋势和潜在问题

预期规划步骤：
1. 理解分析目标和业务问题
2. 收集和准备销售数据
3. 进行数据分析和趋势识别
4. 创建可视化图表
5. 撰写分析报告和建议
6. 向业务方展示结果
```

### 场景3：功能开发
```
规划模板：software_development_template.txt
业务请求：开发一个简单的待办事项管理应用，支持添加、删除和标记完成功能

预期规划步骤：
1. 分析功能需求和用户故事
2. 设计应用架构和数据结构
3. 搭建开发环境
4. 实现核心功能
5. 编写测试用例
6. 部署和发布应用
7. 编写使用文档
```

## 注意事项

1. **模板文件路径**：可以使用相对路径或绝对路径
2. **文件编码**：建议使用 UTF-8 编码
3. **文件大小**：建议模板文件不超过 10KB
4. **模板更新**：修改模板后需要重新运行流程才能生效

## 故障排除

### 问题1：文件读取失败
**原因**：文件路径错误或文件不存在
**解决**：检查文件路径是否正确，使用绝对路径或相对于项目根目录的路径

### 问题2：规划不符合预期
**原因**：模板内容不够具体或业务请求不清晰
**解决**：
- 优化模板内容，添加更具体的步骤说明
- 提供更详细的业务请求描述
- 在规划确认环节提供反馈

### 问题3：人类反馈环节卡住
**原因**：终端输入问题
**解决**：
- 确保在交互式终端中运行
- 按照提示输入 y/n 或直接按 Enter 使用默认值

## 相关文件

- `run_flow.py`：主程序入口
- `app/flow/planning.py`：规划流程实现
- `app/flow/human_interaction.py`：人类交互功能
- `MODIFICATION_RECORD.md`：详细的修改记录
